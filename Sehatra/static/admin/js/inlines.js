"use strict";{const a=django.jQuery;a.fn.formset=function(e){const o=a.extend({},a.fn.formset.defaults,e),t=a(this),s=t.parent();function f(e,t,s){var n=new RegExp("("+t+"-(\\d+|__prefix__))"),s=t+"-"+s;a(e).prop("for")&&a(e).prop("for",a(e).prop("for").replace(n,s)),e.id&&(e.id=e.id.replace(n,s)),e.name&&(e.name=e.name.replace(n,s))}const n=a("#id_"+o.prefix+"-TOTAL_FORMS").prop("autocomplete","off");let c=parseInt(n.val(),10);const p=a("#id_"+o.prefix+"-MAX_NUM_FORMS").prop("autocomplete","off"),i=a("#id_"+o.prefix+"-MIN_NUM_FORMS").prop("autocomplete","off");let u;var l;const r=function(e){e.preventDefault();const t=a("#"+o.prefix+"-empty"),s=t.clone(!0);s.removeClass(o.emptyCssClass).addClass(o.formCssClass).attr("id",o.prefix+"-"+c),d(s),s.find("*").each(function(){f(this,o.prefix,n.val())}),s.insertBefore(a(t)),a(n).val(parseInt(n.val(),10)+1),c+=1,""!==p.val()&&p.val()-n.val()<=0&&u.parent().hide(),h(s.closest(".inline-group")),o.added&&o.added(s),a(document).trigger("formset:added",[s,o.prefix])},d=function(e){e.is("tr")?e.children(":last").append('<div><a class="'+o.deleteCssClass+'" href="#">'+o.deleteText+"</a></div>"):e.is("ul")||e.is("ol")?e.append('<li><a class="'+o.deleteCssClass+'" href="#">'+o.deleteText+"</a></li>"):e.children(":first").append('<span><a class="'+o.deleteCssClass+'" href="#">'+o.deleteText+"</a></span>"),e.find("a."+o.deleteCssClass).on("click",m.bind(this))},m=function(e){e.preventDefault();const t=a(e.target),s=t.closest("."+o.formCssClass);e=s.closest(".inline-group");const n=s.prev();n.length&&n.hasClass("row-form-errors")&&n.remove(),s.remove(),--c,o.removed&&o.removed(s),a(document).trigger("formset:removed",[s,o.prefix]);const i=a("."+o.formCssClass);a("#id_"+o.prefix+"-TOTAL_FORMS").val(i.length),(""===p.val()||0<p.val()-i.length)&&u.parent().show(),h(e);let l,r;function d(){f(this,o.prefix,l)}for(l=0,r=i.length;l<r;l++)f(a(i).get(l),o.prefix,l),a(i.get(l)).find("*").each(d)},h=function(e){""!==i.val()&&0<=i.val()-n.val()?e.find(".inline-deletelink").hide():e.find(".inline-deletelink").show()};t.each(function(e){a(this).not("."+o.emptyCssClass).addClass(o.formCssClass)}),t.filter("."+o.formCssClass+":not(.has_original):not(."+o.emptyCssClass+")").each(function(){d(a(this))}),h(t),u=o.addButton,null===u&&(u="TR"===t.prop("tagName")?(l=t.eq(-1).children().length,s.append('<tr class="'+o.addCssClass+'"><td colspan="'+l+'"><a href="#">'+o.addText+"</a></tr>"),s.find("tr:last a")):(t.filter(":last").after('<div class="'+o.addCssClass+'"><a href="#">'+o.addText+"</a></div>"),t.filter(":last").next().find("a"))),u.on("click",r);e=""===p.val()||0<p.val()-n.val();return t.length&&e?u.parent().show():u.parent().hide(),this},a.fn.formset.defaults={prefix:"form",addText:"add another",deleteText:"remove",addCssClass:"add-row",deleteCssClass:"delete-row",emptyCssClass:"empty-row",formCssClass:"dynamic-form",added:null,removed:null,addButton:null},a.fn.tabularFormset=function(e,t){const s=a(this);return s.formset({prefix:t.prefix,addText:t.addText,formCssClass:"dynamic-"+t.prefix,deleteCssClass:"inline-deletelink",deleteText:t.deleteText,emptyCssClass:"empty-form",added:function(e){var i;(i=e).find(".prepopulated_field").each(function(){const e=a(this),t=e.find("input, select, textarea"),s=t.data("dependency_list")||[],n=[];a.each(s,function(e,t){n.push("#"+i.find(".field-"+t).find("input, select, textarea").attr("id"))}),n.length&&t.prepopulate(n,t.attr("maxlength"))}),"undefined"!=typeof DateTimeShortcuts&&(a(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),"undefined"!=typeof SelectFilter&&(a(".selectfilter").each(function(e,t){var s=t.name.split("-");SelectFilter.init(t.id,s[s.length-1],!1)}),a(".selectfilterstacked").each(function(e,t){var s=t.name.split("-");SelectFilter.init(t.id,s[s.length-1],!0)}))},addButton:t.addButton}),s},a.fn.stackedFormset=function(t,e){const s=a(this);function n(e){a(t).find(".inline_label").each(function(e){e+=1;a(this).html(a(this).html().replace(/(#\d+)/g,"#"+e))})}return s.formset({prefix:e.prefix,addText:e.addText,formCssClass:"dynamic-"+e.prefix,deleteCssClass:"inline-deletelink",deleteText:e.deleteText,emptyCssClass:"empty-form",removed:n,added:function(e){var i;(i=e).find(".prepopulated_field").each(function(){const e=a(this),t=e.find("input, select, textarea"),s=t.data("dependency_list")||[],n=[];a.each(s,function(e,t){n.push("#"+i.find(".form-row .field-"+t).find("input, select, textarea").attr("id"))}),n.length&&t.prepopulate(n,t.attr("maxlength"))}),"undefined"!=typeof DateTimeShortcuts&&(a(".datetimeshortcuts").remove(),DateTimeShortcuts.init()),"undefined"!=typeof SelectFilter&&(a(".selectfilter").each(function(e,t){var s=t.name.split("-");SelectFilter.init(t.id,s[s.length-1],!1)}),a(".selectfilterstacked").each(function(e,t){var s=t.name.split("-");SelectFilter.init(t.id,s[s.length-1],!0)})),n()},addButton:e.addButton}),s},a(document).ready(function(){a(".js-inline-admin-formset").each(function(){var e=a(this).data(),t=e.inlineFormset;let s;switch(e.inlineType){case"stacked":s=t.name+"-group .inline-related",a(s).stackedFormset(s,t.options);break;case"tabular":s=t.name+"-group .tabular.inline-related tbody:first > tr.form-row",a(s).tabularFormset(s,t.options)}})})}